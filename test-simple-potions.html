<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç —É–ø—Ä–æ—â–µ–Ω–Ω–æ–≥–æ API –∑–µ–ª–∏–π</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        .result { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 4px; white-space: pre-wrap; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        .error { color: red; background: #ffe6e6; padding: 10px; border-radius: 4px; }
        .success { color: green; background: #e6ffe6; padding: 10px; border-radius: 4px; }
        .potion-card { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 8px; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç —É–ø—Ä–æ—â–µ–Ω–Ω–æ–≥–æ API –∑–µ–ª–∏–π</h1>
    
    <div class="test-section">
        <h3>–¢–µ—Å—Ç 1: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–¥–∫–æ—Å—Ç–µ–π</h3>
        <button onclick="testRarities()">üìã –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–¥–∫–æ—Å—Ç–∏</button>
        <div id="raritiesResult" class="result"></div>
    </div>
    
    <div class="test-section">
        <h3>–¢–µ—Å—Ç 2: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–ø–æ–≤</h3>
        <button onclick="testTypes()">üîç –ü–æ–ª—É—á–∏—Ç—å —Ç–∏–ø—ã</button>
        <div id="typesResult" class="result"></div>
    </div>
    
    <div class="test-section">
        <h3>–¢–µ—Å—Ç 3: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–µ–ª–∏–π</h3>
        <button onclick="testStats()">üìä –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
        <div id="statsResult" class="result"></div>
    </div>
    
    <div class="test-section">
        <h3>–¢–µ—Å—Ç 4: –°–ª—É—á–∞–π–Ω—ã–µ –∑–µ–ª—å—è</h3>
        <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: <input type="number" id="count" value="2" min="1" max="10"></label>
        <label>–†–µ–¥–∫–æ—Å—Ç—å: 
            <select id="rarity">
                <option value="">–õ—é–±–∞—è</option>
                <option value="common">–û–±—ã—á–Ω–æ–µ</option>
                <option value="uncommon">–ù–µ–æ–±—ã—á–Ω–æ–µ</option>
                <option value="rare">–†–µ–¥–∫–æ–µ</option>
                <option value="very rare">–û—á–µ–Ω—å —Ä–µ–¥–∫–æ–µ</option>
                <option value="legendary">–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ</option>
            </select>
        </label>
        <label>–¢–∏–ø: 
            <select id="type">
                <option value="">–õ—é–±–æ–π</option>
                <option value="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ">ü©π –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</option>
                <option value="–£—Å–∏–ª–µ–Ω–∏–µ">üí™ –£—Å–∏–ª–µ–Ω–∏–µ</option>
                <option value="–ó–∞—â–∏—Ç–∞">üõ°Ô∏è –ó–∞—â–∏—Ç–∞</option>
                <option value="–ò–ª–ª—é–∑–∏—è">üëÅÔ∏è –ò–ª–ª—é–∑–∏—è</option>
                <option value="–¢—Ä–∞–Ω—Å–º—É—Ç–∞—Ü–∏—è">üîÑ –¢—Ä–∞–Ω—Å–º—É—Ç–∞—Ü–∏—è</option>
                <option value="–ù–µ–∫—Ä–æ–º–∞–Ω—Ç–∏—è">üíÄ –ù–µ–∫—Ä–æ–º–∞–Ω—Ç–∏—è</option>
                <option value="–ü—Ä–æ—Ä–∏—Ü–∞–Ω–∏–µ">üîÆ –ü—Ä–æ—Ä–∏—Ü–∞–Ω–∏–µ</option>
            </select>
        </label>
        <button onclick="testRandomPotions()">üé≤ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–µ–ª—å—è</button>
        <div id="randomResult" class="result"></div>
    </div>

    <script>
        async function testRarities() {
            try {
                document.getElementById('raritiesResult').innerHTML = '–ó–∞–≥—Ä—É–∑–∫–∞...';
                
                const response = await fetch('api/generate-potions-simple.php?action=rarities');
                console.log('Response status:', response.status);
                
                const data = await response.json();
                console.log('Response data:', data);
                
                if (data.success) {
                    document.getElementById('raritiesResult').innerHTML = 
                        `<div class="success">‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω—ã —Ä–µ–¥–∫–æ—Å—Ç–∏</div>
                         <h4>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–µ–¥–∫–æ—Å—Ç–∏:</h4>
                         <ul>${data.data.map(rarity => `<li>${rarity}</li>`).join('')}</ul>`;
                } else {
                    document.getElementById('raritiesResult').innerHTML = 
                        `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${data.error}</div>`;
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('raritiesResult').innerHTML = 
                    `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}</div>`;
            }
        }
        
        async function testTypes() {
            try {
                document.getElementById('typesResult').innerHTML = '–ó–∞–≥—Ä—É–∑–∫–∞...';
                
                const response = await fetch('api/generate-potions-simple.php?action=types');
                console.log('Response status:', response.status);
                
                const data = await response.json();
                console.log('Response data:', data);
                
                if (data.success) {
                    document.getElementById('typesResult').innerHTML = 
                        `<div class="success">‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω—ã —Ç–∏–ø—ã</div>
                         <h4>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∏–ø—ã:</h4>
                         <ul>${data.data.map(type => `<li>${type}</li>`).join('')}</ul>`;
                } else {
                    document.getElementById('typesResult').innerHTML = 
                        `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${data.error}</div>`;
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('typesResult').innerHTML = 
                    `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}</div>`;
            }
        }
        
        async function testStats() {
            try {
                document.getElementById('statsResult').innerHTML = '–ó–∞–≥—Ä—É–∑–∫–∞...';
                
                const response = await fetch('api/generate-potions-simple.php?action=stats');
                console.log('Response status:', response.status);
                
                const data = await response.json();
                console.log('Response data:', data);
                
                if (data.success) {
                    const stats = data.data;
                    let html = `<div class="success">‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∞</div>`;
                    html += `<h4>–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>`;
                    html += `<p><strong>–í—Å–µ–≥–æ –∑–µ–ª–∏–π:</strong> ${stats.total_potions}</p>`;
                    
                    html += `<h4>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–µ–¥–∫–æ—Å—Ç–∏:</h4>`;
                    html += `<ul>`;
                    Object.entries(stats.rarity_distribution).forEach(([rarity, count]) => {
                        html += `<li>${rarity}: ${count} –∑–µ–ª–∏–π</li>`;
                    });
                    html += `</ul>`;
                    
                    html += `<h4>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º:</h4>`;
                    html += `<ul>`;
                    Object.entries(stats.type_distribution).forEach(([type, count]) => {
                        html += `<li>${type}: ${count} –∑–µ–ª–∏–π</li>`;
                    });
                    html += `</ul>`;
                    
                    document.getElementById('statsResult').innerHTML = html;
                } else {
                    document.getElementById('statsResult').innerHTML = 
                        `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${data.error}</div>`;
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('statsResult').innerHTML = 
                    `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}</div>`;
            }
        }
        
        async function testRandomPotions() {
            try {
                document.getElementById('randomResult').innerHTML = '–ó–∞–≥—Ä—É–∑–∫–∞...';
                
                const count = document.getElementById('count').value;
                const rarity = document.getElementById('rarity').value;
                const type = document.getElementById('type').value;
                
                const params = new URLSearchParams();
                params.append('action', 'random');
                params.append('count', count);
                if (rarity) params.append('rarity', rarity);
                if (type) params.append('type', type);
                
                const response = await fetch(`api/generate-potions-simple.php?${params.toString()}`);
                console.log('Response status:', response.status);
                
                const data = await response.json();
                console.log('Response data:', data);
                
                if (data.success) {
                    let html = `<div class="success">‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–æ –∑–µ–ª–∏–π: ${data.data.length}</div>`;
                    html += '<h4>–†–µ–∑—É–ª—å—Ç–∞—Ç:</h4>';
                    data.data.forEach((potion, index) => {
                        html += `
                            <div class="potion-card">
                                <h5>${potion.icon} ${potion.name}</h5>
                                <p><strong>–†–µ–¥–∫–æ—Å—Ç—å:</strong> ${potion.rarity}</p>
                                <p><strong>–¢–∏–ø:</strong> ${potion.type}</p>
                                <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${potion.description}</p>
                                <p><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> ${potion.value}</p>
                                <p><strong>–í–µ—Å:</strong> ${potion.weight}</p>
                                <p><strong>–°–≤–æ–π—Å—Ç–≤–∞:</strong> ${potion.properties.join(', ')}</p>
                                <p><strong>–¶–≤–µ—Ç:</strong> <span style="color: ${potion.color}">${potion.color}</span></p>
                            </div>
                        `;
                    });
                    document.getElementById('randomResult').innerHTML = html;
                } else {
                    document.getElementById('randomResult').innerHTML = 
                        `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${data.error}</div>`;
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('randomResult').innerHTML = 
                    `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>

