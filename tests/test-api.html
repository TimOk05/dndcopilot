<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç API –∑–µ–ª–∏–π</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        .result { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 4px; white-space: pre-wrap; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        .error { color: red; background: #ffe6e6; padding: 10px; border-radius: 4px; }
        .success { color: green; background: #e6ffe6; padding: 10px; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç API –∑–µ–ª–∏–π (–ü—Ä–æ—Å—Ç–∞—è –≤–µ—Ä—Å–∏—è)</h1>
    
    <div class="test-section">
        <h3>–¢–µ—Å—Ç 1: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–¥–∫–æ—Å—Ç–µ–π</h3>
        <button onclick="testRarities()">üìã –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–¥–∫–æ—Å—Ç–∏</button>
        <div id="raritiesResult" class="result"></div>
    </div>
    
    <div class="test-section">
        <h3>–¢–µ—Å—Ç 2: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–ø–æ–≤</h3>
        <button onclick="testTypes()">üîç –ü–æ–ª—É—á–∏—Ç—å —Ç–∏–ø—ã</button>
        <div id="typesResult" class="result"></div>
    </div>
    
    <div class="test-section">
        <h3>–¢–µ—Å—Ç 3: –°–ª—É—á–∞–π–Ω—ã–µ –∑–µ–ª—å—è (–±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)</h3>
        <button onclick="testRandomPotions()">üé≤ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–µ–ª—å—è</button>
        <div id="randomResult" class="result"></div>
    </div>

    <script>
        async function testRarities() {
            try {
                document.getElementById('raritiesResult').innerHTML = '–ó–∞–≥—Ä—É–∑–∫–∞...';
                
                const response = await fetch('api/generate-potions.php?action=rarities');
                console.log('Response status:', response.status);
                console.log('Response headers:', response.headers);
                
                const data = await response.json();
                console.log('Response data:', data);
                
                if (data.success) {
                    document.getElementById('raritiesResult').innerHTML = 
                        `<div class="success">‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω—ã —Ä–µ–¥–∫–æ—Å—Ç–∏</div>
                         <h4>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–µ–¥–∫–æ—Å—Ç–∏:</h4>
                         <ul>${data.data.map(rarity => `<li>${rarity}</li>`).join('')}</ul>`;
                } else {
                    document.getElementById('raritiesResult').innerHTML = 
                        `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${data.error}</div>`;
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('raritiesResult').innerHTML = 
                    `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}</div>`;
            }
        }
        
        async function testTypes() {
            try {
                document.getElementById('typesResult').innerHTML = '–ó–∞–≥—Ä—É–∑–∫–∞...';
                
                const response = await fetch('api/generate-potions.php?action=types');
                console.log('Response status:', response.status);
                
                const data = await response.json();
                console.log('Response data:', data);
                
                if (data.success) {
                    document.getElementById('typesResult').innerHTML = 
                        `<div class="success">‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω—ã —Ç–∏–ø—ã</div>
                         <h4>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∏–ø—ã:</h4>
                         <ul>${data.data.map(type => `<li>${type}</li>`).join('')}</ul>`;
                } else {
                    document.getElementById('typesResult').innerHTML = 
                        `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${data.error}</div>`;
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('typesResult').innerHTML = 
                    `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}</div>`;
            }
        }
        
        async function testRandomPotions() {
            try {
                document.getElementById('randomResult').innerHTML = '–ó–∞–≥—Ä—É–∑–∫–∞...';
                
                const response = await fetch('api/generate-potions.php?action=random&count=1');
                console.log('Response status:', response.status);
                
                const data = await response.json();
                console.log('Response data:', data);
                
                if (data.success) {
                    let html = `<div class="success">‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–æ –∑–µ–ª–∏–π: ${data.data.length}</div>`;
                    html += '<h4>–†–µ–∑—É–ª—å—Ç–∞—Ç:</h4>';
                    data.data.forEach((potion, index) => {
                        html += `
                            <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 4px;">
                                <h5>${potion.icon} ${potion.name}</h5>
                                <p><strong>–†–µ–¥–∫–æ—Å—Ç—å:</strong> ${potion.rarity}</p>
                                <p><strong>–¢–∏–ø:</strong> ${potion.type}</p>
                                <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${potion.description}</p>
                            </div>
                        `;
                    });
                    document.getElementById('randomResult').innerHTML = html;
                } else {
                    document.getElementById('randomResult').innerHTML = 
                        `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${data.error}</div>`;
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('randomResult').innerHTML = 
                    `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}</div>`;
            }
        }
    </script>
</body>
</html>
